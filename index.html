<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gerador de Propostas ‚Ä¢ Esquadrias</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="brand">
        <img id="brandLogo" src="assets/logo.svg" alt="Logo" />
        <div>
          <strong>ESQUADRIAS</strong>
          <span>Gerador de Propostas</span>
        </div>
      </div>
      <div class="actions">
        <button id="btnNovaProposta">Nova proposta</button>
        <button id="btnSalvar">Salvar</button>
        <button id="btnExportarJSON" title="Exportar Backup">üíæ JSON</button>
        <button id="btnImportarJSON" title="Importar Backup">üìÇ JSON</button>
        <input type="file" id="inputImportarJSON" accept=".json" style="display:none" />
        <button id="btnPDF" class="primary">Exportar PDF</button>
      </div>
    </header>

    <main class="grid">
      <section class="panel form-panel">
        <h2>üìã Gerenciar Propostas</h2>
        <div class="propostas-manager">
          <div class="field-row">
            <div class="field-group">
              <label>Nome da Proposta</label>
              <input id="nomeProposta" placeholder="Ex: Jo√£o Silva - Residencial" />
            </div>
            <div class="field-group">
              <button type="button" id="btnSalvarProposta" class="primary">Salvar Proposta</button>
            </div>
          </div>
          <div class="field-group">
            <label>Buscar Propostas</label>
            <input id="buscaProposta" placeholder="Buscar por nome, cliente ou n√∫mero..." />
          </div>
          <div class="propostas-lista">
            <div id="listaPropostas"></div>
          </div>
        </div>

        <h2>Dados da Empresa (Emitente)</h2>
        <form id="formEmpresa" autocomplete="off">
          <div class="field-row">
            <div class="field-group" style="grid-column: 1 / -1;">
              <label>Logo da empresa</label>
              <input name="logo" type="file" accept="image/*" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Empresa</label>
              <input name="empresa" placeholder="Nome/Raz√£o Social" />
            </div>
            <div class="field-group">
              <label>CNPJ</label>
              <input name="cnpj" />
            </div>
            <div class="field-group">
              <label>IE (opcional)</label>
              <input name="ie" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Telefone</label>
              <input name="telefone" />
            </div>
            <div class="field-group">
              <label>E-mail</label>
              <input name="email" type="email" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group" style="grid-column: 1 / -1;">
              <label>Endere√ßo</label>
              <input name="endereco" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Cidade</label>
              <input name="cidade" />
            </div>
            <div class="field-group">
              <label>CEP</label>
              <input name="cep" />
            </div>
          </div>
        </form>

        <h2>Dados da Proposta</h2>
        <form id="formDados" autocomplete="off">
          <div class="field-group">
            <label>Cliente</label>
            <input name="cliente" placeholder="Nome/Raz√£o Social" />
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>CPF/CNPJ</label>
              <input name="cpfcnpj" />
            </div>
            <div class="field-group">
              <label>Contato</label>
              <input name="contato" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Telefone</label>
              <input name="telefone" />
            </div>
            <div class="field-group">
              <label>E-mail</label>
              <input name="email" type="email" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>End. Obra</label>
              <input name="endereco" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Cidade</label>
              <input name="cidade" />
            </div>
            <div class="field-group">
              <label>CEP</label>
              <input name="cep" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Proposta N¬∫</label>
              <input name="numero" placeholder="AA-00-0000" />
            </div>
            <div class="field-group">
              <label>Obra</label>
              <input name="obra" />
            </div>
          </div>
          <div class="field-group">
            <label>Prazo de Execu√ß√£o</label>
            <input name="prazo" placeholder="ex.: 30 dias" />
          </div>
        </form>

        <h2>Especifica√ß√µes T√©cnicas</h2>
        <form id="formEspecificacoes" autocomplete="off">
          <div class="field-row">
            <div class="field-group">
              <label>Tipo de Vidros</label>
              <input name="vidroTipo" placeholder="ex.: Temperados" />
            </div>
            <div class="field-group">
              <label>Espessura (mm)</label>
              <input name="vidroEspessura" placeholder="ex.: 8" />
            </div>
            <div class="field-group">
              <label>Acabamento</label>
              <input name="vidroAcabamento" placeholder="ex.: incolor" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Linha dos Perfis</label>
              <input name="perfilLinha" placeholder="ex.: Linha padr√£o" />
            </div>
            <div class="field-group">
              <label>Acabamento Perfis</label>
              <input name="perfilAcabamento" placeholder="ex.: preto fosco" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Ferragens</label>
              <input name="ferragens" placeholder="ex.: Inclusas (roldanas, fechos, escovas)" />
            </div>
            <div class="field-group">
              <label>Instala√ß√£o</label>
              <input name="instalacao" placeholder="ex.: Inclusa, equipe especializada" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Garantia Fabrica√ß√£o (anos)</label>
              <input name="garantiaFabricacao" placeholder="ex.: 1" />
            </div>
            <div class="field-group">
              <label>Garantia Instala√ß√£o (meses)</label>
              <input name="garantiaInstalacao" placeholder="ex.: 3" />
            </div>
          </div>
          <div class="field-group">
            <label>Normas T√©cnicas</label>
            <input name="normasTecnicas" placeholder="ex.: ABNT NBR 7199 e NBR 10821" />
          </div>
        </form>

        <h2>üìù Templates de Texto</h2>
        <div class="templates-section">
          <div class="field-row">
            <div class="field-group">
              <label>Template de Forma de Pagamento</label>
              <select id="templateFormaPagamento">
                <option value="">Selecione...</option>
              </select>
            </div>
            <div class="field-group">
              <button type="button" id="btnAplicarTemplateFormaPagamento">Aplicar</button>
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Template de Observa√ß√µes Comerciais</label>
              <select id="templateObsComerciais">
                <option value="">Selecione...</option>
              </select>
            </div>
            <div class="field-group">
              <button type="button" id="btnAplicarTemplateObsComerciais">Aplicar</button>
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Template de Observa√ß√µes Gerais</label>
              <select id="templateObsGerais">
                <option value="">Selecione...</option>
              </select>
            </div>
            <div class="field-group">
              <button type="button" id="btnAplicarTemplateObsGerais">Aplicar</button>
            </div>
          </div>
        </div>

        <h2>Condi√ß√µes Comerciais</h2>
        <form id="formCondicoes" autocomplete="off">
          <div class="field-group">
            <label>Forma de Pagamento</label>
            <textarea name="formaPagamento" rows="2" placeholder="Ex: 50% de sinal no aceite da proposta e 50% na conclus√£o da instala√ß√£o"></textarea>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Prazo de Entrega (dias √∫teis)</label>
              <input name="prazoEntrega" placeholder="ex.: 30" />
            </div>
            <div class="field-group">
              <label>Prazo de Instala√ß√£o (dias √∫teis)</label>
              <input name="prazoInstalacao" placeholder="ex.: 5" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Validade da Proposta (dias)</label>
              <input name="validadeProposta" placeholder="ex.: 15" />
            </div>
            <div class="field-group">
              <label>Garantia Perfis (anos)</label>
              <input name="garantiaPerfis" placeholder="ex.: 5" />
            </div>
            <div class="field-group">
              <label>Garantia Vidros/Instala√ß√£o (anos)</label>
              <input name="garantiaVidros" placeholder="ex.: 1" />
            </div>
          </div>
          <div class="field-group">
            <label>Observa√ß√µes Comerciais</label>
            <textarea name="observacoesComerciais" rows="3" placeholder="Ex: Esta proposta n√£o inclui servi√ßos de alvenaria, pintura ou arremates"></textarea>
          </div>
        </form>

        <h2>Observa√ß√µes Gerais</h2>
        <form id="formObservacoes" autocomplete="off">
          <div class="field-group">
            <label>√Årea de Cobertura (Transporte/Instala√ß√£o)</label>
            <input name="areaCobertura" placeholder="ex.: √°rea urbana de Goi√¢nia" />
          </div>
          <div class="field-group">
            <label>Observa√ß√£o sobre Altera√ß√µes</label>
            <input name="observacaoAlteracoes" placeholder="ex.: Altera√ß√µes nas medidas ap√≥s confer√™ncia t√©cnica poder√£o implicar revis√£o de valores" />
          </div>
          <div class="field-group">
            <label>Observa√ß√µes Adicionais</label>
            <textarea name="observacoesAdicionais" rows="3" placeholder="Informa√ß√µes complementares"></textarea>
          </div>
        </form>


        <h2>üßÆ C√°lculos e Descontos</h2>
        <form id="formCalculos" autocomplete="off">
          <div class="field-row">
            <div class="field-group">
              <label>Tipo de Desconto</label>
              <select name="descontoTipo">
                <option value="percentual">Percentual (%)</option>
                <option value="fixo">Valor Fixo (R$)</option>
              </select>
            </div>
            <div class="field-group">
              <label>Valor do Desconto</label>
              <input name="descontoValor" type="number" min="0" step="0.01" placeholder="0" />
            </div>
          </div>
          
          <div class="calculos-info">
            <div><strong>√Årea Total:</strong> <span id="calc-area">0</span> m¬≤</div>
            <div><strong>Pre√ßo M√©dio/m¬≤:</strong> R$ <span id="calc-preco-m2">0,00</span></div>
            <div><strong>Valor sem Desconto:</strong> R$ <span id="calc-sem-desconto">0,00</span></div>
            <div><strong>Desconto:</strong> R$ <span id="calc-desconto">0,00</span></div>
            <div class="total-final"><strong>Valor Final:</strong> R$ <span id="calc-com-desconto">0,00</span></div>
          </div>
        </form>

        <h2>Itens</h2>
        <form id="formItem" class="item-form" autocomplete="off">
          <div class="field-row">
            <div class="field-group">
              <label>Produto</label>
              <select name="produto" id="selProduto">
                <option value="livre">Produto livre (descri√ß√£o manual)</option>
              </select>
            </div>
            <div class="field-group">
              <label>Qtd</label>
              <input name="qtd" type="number" min="1" value="1" />
            </div>
            <div class="field-group">
              <label>L (mm)</label>
              <input name="largura" type="number" min="0" />
            </div>
            <div class="field-group">
              <label>H (mm)</label>
              <input name="altura" type="number" min="0" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>Linha</label>
              <input name="linha" placeholder="Suprema" />
            </div>
            <div class="field-group">
              <label>Localiza√ß√£o</label>
              <input name="local" placeholder="ex.: Sala, Quarto" />
            </div>
            <div class="field-group">
              <label>Cor</label>
              <input name="cor" placeholder="ex.: RAL9005F" />
            </div>
            <div class="field-group">
              <label>Vidros</label>
              <input name="vidro" placeholder="ex.: Temperado 6mm incolor" />
            </div>
          </div>
          <div class="field-row">
            <div class="field-group" style="grid-column: 1 / -1;">
              <label>Descri√ß√£o do produto (quando escolher "livre")</label>
              <input name="descricao" placeholder="Ex.: Janela de Correr sob medida" />
            </div>
          </div>
          <div class="field-group" id="prodCampos"></div>
          <div class="field-group">
            <label>Caracter√≠sticas personalizadas</label>
            <div id="caracteristicasList" class="attr-list"></div>
            <div class="item-actions">
              <button type="button" id="btnAddCaracteristica">Adicionar caracter√≠stica</button>
            </div>
          </div>
          <div class="field-group">
            <label>Imagens do Produto (opcional)</label>
            <input type="file" id="uploadImagemItem" accept="image/*" multiple />
            <div id="imagensItemPreview" class="imagens-preview"></div>
          </div>
          <div class="field-row">
            <div class="field-group">
              <label>C√≥digo (auto)</label>
              <input name="codigo" placeholder="J1" disabled />
            </div>
            <div class="field-group">
              <label>Observa√ß√µes</label>
              <input name="obs" />
            </div>
            <div class="field-group">
              <label>Pre√ßo (R$)</label>
              <input name="preco" type="number" min="0" step="0.01" />
            </div>
          </div>
          <div class="item-actions">
            <button type="button" id="btnAdicionar" class="primary">Adicionar item</button>
            <span id="statusItem" class="muted"></span>
          </div>
        </form>

        <div class="tabela-itens" id="tabelaItens"></div>

        <h2>Cat√°logo de Produtos (Modelos)</h2>
        <form id="formCatalogo" class="catalogo-form" autocomplete="off">
          <div class="field-row">
            <div class="field-group" style="grid-column: 1 / -1;">
              <label>Nome do modelo</label>
              <input name="nome" placeholder="Ex.: Janela de Correr - 4 Folhas - Suprema" />
            </div>
          </div>
          <div class="field-group">
            <label>Campos do modelo</label>
            <div id="catalogoCampos" class="attr-list"></div>
            <div class="item-actions">
              <button type="button" id="btnAddCampo">Adicionar campo</button>
              <button type="button" id="btnSalvarModelo" class="primary">Salvar modelo</button>
            </div>
          </div>
          <div id="catalogoLista" class="catalogo-list"></div>
        </form>
      </section>

      <section class="panel preview-panel">
        <div id="propostaPreview" class="proposta">
          <div class="topline">
            <div>
              <h1>Proposta N¬∫ <span id="pv-numero">00-00-0000</span></h1>
              <div id="pv-obra" class="obra">OBRA</div>
            </div>
            <div class="empresa">
              <img id="pv-emp-logo" alt="Logo da empresa" />
              <div id="pv-emp-nome">‚Äî</div>
              <div class="muted"><span id="pv-emp-doc">‚Äî</span></div>
              <div class="muted"><span id="pv-emp-contato">‚Äî</span></div>
              <div class="muted"><span id="pv-emp-end">‚Äî</span></div>
            </div>
          </div>

          <div class="info">
            <div><strong>Cliente:</strong> <span id="pv-cliente">‚Äî</span></div>
            <div><strong>CPF/CNPJ:</strong> <span id="pv-cpfcnpj">‚Äî</span></div>
            <div><strong>Contato:</strong> <span id="pv-contato">‚Äî</span></div>
            <div><strong>Telefone:</strong> <span id="pv-telefone">‚Äî</span></div>
            <div><strong>E-mail:</strong> <span id="pv-email">‚Äî</span></div>
            <div><strong>End. Obra:</strong> <span id="pv-endereco">‚Äî</span></div>
            <div><strong>Cidade:</strong> <span id="pv-cidade">‚Äî</span></div>
            <div><strong>CEP:</strong> <span id="pv-cep">‚Äî</span></div>
            <div class="prazo"><strong>Prazo de Execu√ß√£o:</strong> <span id="pv-prazo">‚Äî</span></div>
          </div>

          <h3 class="section-title">Especifica√ß√µes T√©cnicas</h3>
          <div class="specs-section">
            <div><strong>Vidros:</strong> <span id="pv-vidros">‚Äî</span></div>
            <div><strong>Perfis de alum√≠nio:</strong> <span id="pv-perfis">‚Äî</span></div>
            <div><strong>Ferragens:</strong> <span id="pv-ferragens">‚Äî</span></div>
            <div><strong>Instala√ß√£o:</strong> <span id="pv-instalacao">‚Äî</span></div>
            <div><strong>Garantia:</strong> <span id="pv-garantia-espec">‚Äî</span></div>
            <div><strong>Normas t√©cnicas:</strong> <span id="pv-normas">‚Äî</span></div>
          </div>

          <h3 class="section-title">Itens da Proposta</h3>
          <div id="pv-itens" class="itens"></div>


          <div class="calculos-preview">
            <div><strong>√Årea Total:</strong> <span id="pv-area-total">0</span> m¬≤</div>
            <div><strong>Pre√ßo M√©dio/m¬≤:</strong> R$ <span id="pv-preco-m2">0,00</span></div>
            <div><strong>Valor sem Desconto:</strong> R$ <span id="pv-valor-sem-desconto">0,00</span></div>
            <div id="pv-desconto-wrapper" style="display:none"><strong>Desconto:</strong> R$ <span id="pv-desconto-valor">0,00</span></div>
            <div class="total-destaque"><strong>Valor Final:</strong> R$ <span id="pv-valor-com-desconto">0,00</span></div>
          </div>

          <div class="totais">
            <div><strong>Total de Itens:</strong> <span id="pv-totalItens">0</span></div>
            <div><strong>Valor Total:</strong> R$ <span id="pv-valorTotal">0,00</span></div>
          </div>

          <h3 class="section-title">Condi√ß√µes Comerciais</h3>
          <div class="comercial-section">
            <div><strong>Prazo de entrega:</strong> <span id="pv-prazo-entrega">‚Äî</span></div>
            <div><strong>Prazo de instala√ß√£o:</strong> <span id="pv-prazo-instalacao">‚Äî</span></div>
            <div><strong>Validade da proposta:</strong> <span id="pv-validade">‚Äî</span></div>
            <div><strong>Forma de pagamento:</strong> <span id="pv-forma-pagamento">‚Äî</span></div>
            <div><strong>Garantia:</strong> <span id="pv-garantia">‚Äî</span></div>
            <div id="pv-obs-comerciais-wrapper" style="display: none;"><strong>Observa√ß√µes:</strong> <span id="pv-obs-comerciais">‚Äî</span></div>
          </div>

          <h3 class="section-title">Observa√ß√µes</h3>
          <div class="obs-section">
            <div id="pv-area-cobertura-wrapper" style="display: none;">‚Ä¢ <span id="pv-area-cobertura">‚Äî</span></div>
            <div id="pv-obs-alteracoes-wrapper" style="display: none;">‚Ä¢ <span id="pv-obs-alteracoes">‚Äî</span></div>
            <div id="pv-obs-adicionais-wrapper" style="display: none;">‚Ä¢ <span id="pv-obs-adicionais">‚Äî</span></div>
          </div>

          <footer class="rodape">
            <div>Emitido por <span id="pv-usuario">ADMINISTRADOR</span> em <span id="pv-data">‚Äî</span></div>
            <div class="muted">Este documento √© um or√ßamento; valores podem variar conforme obra.</div>
          </footer>
        </div>
      </section>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="app.js"></script>
  </body>
  </html>

